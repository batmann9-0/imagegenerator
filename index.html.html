<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BATMAN AI Image Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Outfit', sans-serif;
            background: radial-gradient(circle at top left, #1a1c2e, #0f1016);
            min-height: 100vh;
            color: white;
        }

        /* Glassmorphism Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        .input-focus:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f1016; 
        }
        ::-webkit-scrollbar-thumb {
            background: #2d3047; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #434766; 
        }

        /* Animations */
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 15px rgba(99, 102, 241, 0.3); }
            50% { box-shadow: 0 0 25px rgba(99, 102, 241, 0.6); }
        }

        .loading-pulse {
            animation: pulse-glow 2s infinite;
        }

        .aspect-btn.active {
            background-color: #4f46e5;
            border-color: #4f46e5;
            color: white;
        }

        /* Image Placeholder Pattern */
        .placeholder-pattern {
            background-color: #1e2130;
            background-image: radial-gradient(#2d3047 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="flex items-center justify-center p-4 sm:p-6">

    <div class="w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-8">
        
        <!-- LEFT SIDE: Controls -->
        <div class="glass-card rounded-3xl p-6 sm:p-8 flex flex-col h-full animate-fade-in-up">
            <div class="mb-8">
                <div class="flex items-center gap-3 mb-2">
                    <div class="bg-indigo-500/20 p-2 rounded-lg text-indigo-400">
                        <i class="fa-solid fa-wand-magic-sparkles text-xl"></i>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400">
                        AI Generator
                    </h1>
                </div>
                <p class="text-gray-400 text-sm">Powered by UOP STUDENT</p>
            </div>

            <form id="generatorForm" class="space-y-6 flex-grow">
                
                <!-- Prompt Input -->
                <div class="space-y-2">
                    <label class="text-sm font-medium text-gray-300 ml-1">Enter your imagination</label>
                    <textarea 
                        id="promptInput" 
                        rows="4" 
                        class="w-full bg-[#0f1016]/50 border border-gray-700/50 rounded-xl p-4 text-gray-100 placeholder-gray-500 focus:outline-none input-focus transition-all resize-none"
                        placeholder="A futuristic city floating in the clouds, cyberpunk style, neon lights, 8k resolution..."
                        required></textarea>
                </div>

                <!-- Settings Grid -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                    
                    <!-- Aspect Ratio -->
                    <div class="space-y-2">
                        <label class="text-sm font-medium text-gray-300 ml-1">Aspect Ratio</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button type="button" data-ratio="square" class="aspect-btn active border border-gray-700/50 bg-[#0f1016]/30 rounded-lg p-3 text-xs font-medium text-gray-400 hover:bg-white/5 transition-all flex flex-col items-center gap-2">
                                <div class="w-4 h-4 border-2 border-current rounded-sm"></div>
                                Square
                            </button>
                            <button type="button" data-ratio="portrait" class="aspect-btn border border-gray-700/50 bg-[#0f1016]/30 rounded-lg p-3 text-xs font-medium text-gray-400 hover:bg-white/5 transition-all flex flex-col items-center gap-2">
                                <div class="w-3 h-4 border-2 border-current rounded-sm"></div>
                                Portrait
                            </button>
                            <button type="button" data-ratio="landscape" class="aspect-btn border border-gray-700/50 bg-[#0f1016]/30 rounded-lg p-3 text-xs font-medium text-gray-400 hover:bg-white/5 transition-all flex flex-col items-center gap-2">
                                <div class="w-5 h-3 border-2 border-current rounded-sm"></div>
                                Land...
                            </button>
                        </div>
                        <input type="hidden" id="aspectRatio" value="square">
                    </div>

                    <!-- Style Preset (Extra Feature) -->
                    <div class="space-y-2">
                        <label class="text-sm font-medium text-gray-300 ml-1">Art Style</label>
                        <div class="relative">
                            <select id="styleSelect" class="w-full appearance-none bg-[#0f1016]/30 border border-gray-700/50 rounded-xl p-3 pl-4 pr-10 text-gray-300 focus:outline-none input-focus transition-all cursor-pointer">
                                <option value="">None (Raw)</option>
                                <option value="cinematic lighting, 8k, highly detailed, photorealistic">Cinematic Realistic</option>
                                <option value="anime style, studio ghibli, vibrant colors">Anime / Manga</option>
                                <option value="cyberpunk, neon lights, futuristic, dark atmosphere">Cyberpunk</option>
                                <option value="3d render, octane render, unreal engine 5, cute">3D Character</option>
                                <option value="oil painting, vincent van gogh style, artistic">Oil Painting</option>
                                <option value="pencil sketch, black and white, charcoal">Sketch</option>
                            </select>
                            <div class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none">
                                <i class="fa-solid fa-chevron-down text-xs"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Generate Button -->
                <button type="submit" id="generateBtn" class="w-full group relative overflow-hidden bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl p-4 font-semibold transition-all duration-300 shadow-lg shadow-indigo-900/20 mt-4">
                    <span class="relative z-10 flex items-center justify-center gap-2">
                        <i class="fa-solid fa-rocket"></i>
                        <span id="btnText">Generate Artwork</span>
                    </span>
                    <div class="absolute inset-0 bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </button>
            </form>
        </div>

        <!-- RIGHT SIDE: Preview -->
        <div class="glass-card rounded-3xl p-4 sm:p-8 flex flex-col h-full min-h-[400px] lg:min-h-[600px] relative overflow-hidden">
            
            <!-- Header for Right Side -->
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-medium text-gray-200">Result</h2>
                <div id="statusBadge" class="hidden px-3 py-1 rounded-full bg-yellow-500/10 text-yellow-400 text-xs font-medium border border-yellow-500/20 flex items-center gap-2">
                    <span class="w-2 h-2 bg-yellow-400 rounded-full animate-pulse"></span>
                    Processing...
                </div>
            </div>

            <!-- Image Container -->
            <div class="flex-grow rounded-2xl overflow-hidden placeholder-pattern border border-gray-700/30 relative group flex items-center justify-center">
                
                <!-- Placeholder State -->
                <div id="placeholderState" class="text-center p-6">
                    <div class="w-20 h-20 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-600">
                        <i class="fa-regular fa-image text-3xl"></i>
                    </div>
                    <p class="text-gray-400 text-sm">Your generated artwork will appear here</p>
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="hidden absolute inset-0 bg-black/60 backdrop-blur-sm flex flex-col items-center justify-center z-20">
                    <div class="relative w-24 h-24 mb-4">
                        <div class="absolute inset-0 border-4 border-indigo-500/30 rounded-full"></div>
                        <div class="absolute inset-0 border-4 border-t-indigo-500 rounded-full animate-spin"></div>
                        <div class="absolute inset-4 bg-indigo-500 rounded-full animate-pulse opacity-20"></div>
                    </div>
                    <p class="text-indigo-200 font-medium animate-pulse">Creating Masterpiece...</p>
                    <p class="text-gray-500 text-xs mt-2">This may take a few seconds</p>
                </div>

                <!-- Actual Image -->
                <img id="resultImage" src="" alt="Generated Image" class="hidden w-full h-full object-contain transition-transform duration-500 hover:scale-105 z-10">

                <!-- Action Overlay (Download) -->
                <div id="actionOverlay" class="hidden absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/90 to-transparent translate-y-full group-hover:translate-y-0 transition-transform duration-300 z-20 flex justify-center gap-4">
                    <a id="downloadLink" href="#" target="_blank" class="bg-white text-black px-6 py-2 rounded-full font-medium text-sm hover:bg-gray-200 transition-colors flex items-center gap-2">
                        <i class="fa-solid fa-download"></i> Download
                    </a>
                    <button onclick="window.open(document.getElementById('resultImage').src, '_blank')" class="bg-gray-800/80 backdrop-blur text-white px-6 py-2 rounded-full font-medium text-sm hover:bg-gray-700 transition-colors border border-gray-600">
                        <i class="fa-solid fa-expand"></i> Full Size
                    </button>
                </div>
            </div>
            
            <!-- Error Message -->
            <div id="errorMessage" class="hidden mt-4 p-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-200 text-sm flex items-center gap-3">
                <i class="fa-solid fa-circle-exclamation text-red-400"></i>
                <span id="errorText">Something went wrong. Please try again.</span>
            </div>

        </div>

    </div>

    <script>
        // UI Elements
        const form = document.getElementById('generatorForm');
        const promptInput = document.getElementById('promptInput');
        const styleSelect = document.getElementById('styleSelect');
        const aspectRatioInput = document.getElementById('aspectRatio');
        const aspectBtns = document.querySelectorAll('.aspect-btn');
        const generateBtn = document.getElementById('generateBtn');
        const btnText = document.getElementById('btnText');
        
        const resultImage = document.getElementById('resultImage');
        const placeholderState = document.getElementById('placeholderState');
        const loadingState = document.getElementById('loadingState');
        const actionOverlay = document.getElementById('actionOverlay');
        const statusBadge = document.getElementById('statusBadge');
        const errorMessage = document.getElementById('errorMessage');
        const errorText = document.getElementById('errorText');
        const downloadLink = document.getElementById('downloadLink');

        // Aspect Ratio Handling
        aspectBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all
                aspectBtns.forEach(b => b.classList.remove('active', 'bg-[#4f46e5]', 'text-white', 'border-[#4f46e5]'));
                aspectBtns.forEach(b => b.classList.add('bg-[#0f1016]/30', 'text-gray-400', 'border-gray-700/50'));
                
                // Add active class to clicked
                btn.classList.remove('bg-[#0f1016]/30', 'text-gray-400', 'border-gray-700/50');
                btn.classList.add('active', 'bg-[#4f46e5]', 'text-white', 'border-[#4f46e5]');
                
                // Set hidden input value
                aspectRatioInput.value = btn.dataset.ratio;
            });
        });

        // Form Submission
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // 1. Get Values
            const rawPrompt = promptInput.value.trim();
            const style = styleSelect.value;
            const aspectRatio = aspectRatioInput.value;

            if (!rawPrompt) return;

            // 2. Construct Final Prompt (Prompt + Style)
            const finalPrompt = style ? `${rawPrompt}, ${style}` : rawPrompt;

            // 3. UI Loading State
            setLoading(true);
            errorMessage.classList.add('hidden');
            
            // 4. API Call
            try {
                // Using the specific API endpoint provided
                const baseUrl = "https://famofc.site/api/generate.php";
                // Encode parameters to ensure special characters don't break the URL
                const url = `${baseUrl}?prompt=${encodeURIComponent(finalPrompt)}&aspectRatio=${aspectRatio}`;

                const response = await fetch(url);
                
                // Check if response is JSON
                const data = await response.json();

                if (data.success && data.images && data.images.length > 0) {
                    const imageUrl = data.images[0].image_url;
                    displayImage(imageUrl);
                } else {
                    throw new Error("API returned success: false or no images found.");
                }

            } catch (error) {
                console.error("Generation Error:", error);
                showError("Failed to generate image. The server might be busy. Please try again.");
            } finally {
                setLoading(false);
            }
        });

        // Helper Functions
        function setLoading(isLoading) {
            if (isLoading) {
                generateBtn.disabled = true;
                generateBtn.classList.add('opacity-70', 'cursor-not-allowed');
                btnText.textContent = "Dreaming...";
                
                placeholderState.classList.add('hidden');
                resultImage.classList.add('hidden');
                actionOverlay.classList.add('hidden');
                
                loadingState.classList.remove('hidden');
                statusBadge.classList.remove('hidden');
            } else {
                generateBtn.disabled = false;
                generateBtn.classList.remove('opacity-70', 'cursor-not-allowed');
                btnText.textContent = "Generate Artwork";
                
                loadingState.classList.add('hidden');
                statusBadge.classList.add('hidden');
            }
        }

        function displayImage(url) {
            // Create a new image object to pre-load it before showing
            const img = new Image();
            img.onload = () => {
                resultImage.src = url;
                resultImage.classList.remove('hidden');
                actionOverlay.classList.remove('hidden');
                downloadLink.href = url;
            };
            img.src = url;
        }

        function showError(msg) {
            errorText.textContent = msg;
            errorMessage.classList.remove('hidden');
            placeholderState.classList.remove('hidden');
        }
    </script>
</body>
</html>